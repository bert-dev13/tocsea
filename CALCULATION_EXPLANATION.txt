================================================================================
TOCSEA: COASTAL SOIL EROSION PREDICTION SYSTEM
CALCULATION FORMULAS AND EXPLANATIONS
================================================================================

This document explains how the TOCSEA system calculates:
1. Predicted Soil Loss
2. Recommended Number of Plants/Trees

================================================================================
PART 1: SOIL LOSS CALCULATION
================================================================================

The system predicts soil loss using a mathematical formula based on three key
environmental factors:

FORMULA:
--------
Predicted Soil Loss = 81610.062 - (54.458 × S) + (2665.351 × T) + (2048.205 × F)

Where:
  S = Seawall Length (in meters)
  T = Number of Typhoons per Year
  F = Number of Floods per Year

FORMULA COEFFICIENTS:
---------------------
Constant (Base Value):       81610.062
Seawall Coefficient:         -54.458   (negative = reduces erosion)
Typhoon Coefficient:         2665.351  (positive = increases erosion)
Flood Coefficient:           2048.205  (positive = increases erosion)

HOW IT WORKS:
-------------
1. The formula starts with a base value of 81,610.062 metric tons per year
2. Seawall length REDUCES soil loss (negative coefficient)
   - More seawall = less erosion
   - Example: 100m seawall reduces loss by 5,445.8 tons
3. Typhoons INCREASE soil loss (positive coefficient)
   - More typhoons = more erosion
   - Example: 2 typhoons add 5,330.7 tons
4. Floods INCREASE soil loss (positive coefficient)
   - More floods = more erosion
   - Example: 1 flood adds 2,048.2 tons
5. Final result cannot be negative (system uses max(0, result))

EXAMPLE CALCULATION:
--------------------
Input:
  Seawall Length: 150 meters
  Typhoons per Year: 3
  Floods per Year: 2

Calculation:
  Step 1: Base value = 81610.062
  Step 2: Seawall effect = -54.458 × 150 = -8,168.7
  Step 3: Typhoon effect = 2665.351 × 3 = 7,996.053
  Step 4: Flood effect = 2048.205 × 2 = 4,096.41
  
  Predicted Soil Loss = 81610.062 - 8168.7 + 7996.053 + 4096.41
                      = 85,533.825 metric tons per year

================================================================================
PART 2: PLANT/TREE RECOMMENDATION CALCULATION
================================================================================

The system recommends specific plants and trees based on:
1. Predicted soil loss amount
2. Selected soil type

FORMULA BASIS:
--------------
Basic Rule: 1 tree/plant per 5 metric tons of soil loss

This means: Total Plants Needed = ceil(Soil Loss ÷ 5)

CALCULATION STEPS:
------------------

STEP 1: Calculate Total Plants Needed
   totalPlantsNeeded = ceil(soilLoss / 5)
   
   Example: If soil loss = 50 tons
   totalPlantsNeeded = ceil(50 / 5) = ceil(10) = 10 plants

STEP 2: Distribute Plants by Type (Based on Soil Type)
   For each plant type, calculate:
   quantity = ceil(totalPlantsNeeded × plant.ratio)
   
   Where plant.ratio is the percentage of that plant type:
   - Ratio 0.4 = 40% of total plants
   - Ratio 0.3 = 30% of total plants
   - Ratio 0.2 = 20% of total plants
   - etc.

STEP 3: Apply Adjustments
   a) Minimum Quantity Rule:
      If soil loss > 0 but calculated quantity = 0, set quantity = 1
   
   b) High Soil Loss Adjustment:
      If soil loss > 100 tons, multiply quantity by 1.2 (20% increase)
      This accounts for more severe erosion requiring more plants

COMPLETE EXAMPLE:
-----------------
Scenario:
  Soil Loss: 75 metric tons per year
  Soil Type: Sandy Soil

Step 1: Calculate Total Plants Needed
  totalPlantsNeeded = ceil(75 / 5) = ceil(15) = 15 plants

Step 2: Distribute by Plant Type (Sandy Soil ratios)
  Sandy Soil Plant Recommendations:
    - Coconut trees:     ratio = 0.4
    - Pandan:            ratio = 0.3
    - Mangrove:          ratio = 0.3
    - Beach morning glory: ratio = 0.2
    - Sea purslane:      ratio = 0.25
  
  Calculations:
    Coconut trees:      ceil(15 × 0.4) = ceil(6.0) = 6 trees
    Pandan:             ceil(15 × 0.3) = ceil(4.5) = 5 plants
    Mangrove:           ceil(15 × 0.3) = ceil(4.5) = 5 trees
    Beach morning glory: ceil(15 × 0.2) = ceil(3.0) = 3 plants
    Sea purslane:       ceil(15 × 0.25) = ceil(3.75) = 4 plants

Step 3: Check Adjustments
  - Soil loss (75 tons) is not > 100, so no high loss adjustment needed
  - All quantities are > 0, so no minimum adjustment needed

Final Recommendations:
  - Coconut trees: 6 trees
  - Pandan: 5 plants
  - Mangrove: 5 trees
  - Beach morning glory: 3 plants
  - Sea purslane: 4 plants
  
  Total: 23 plants/trees (note: sum may exceed totalPlantsNeeded due to rounding)

EXAMPLE WITH HIGH SOIL LOSS:
-----------------------------
Scenario:
  Soil Loss: 150 metric tons per year
  Soil Type: Clay Soil
  Selected Plant: Mangrove (ratio = 0.35)

Step 1: Calculate Total Plants Needed
  totalPlantsNeeded = ceil(150 / 5) = 30 plants

Step 2: Calculate Initial Quantity
  Mangrove quantity = ceil(30 × 0.35) = ceil(10.5) = 11 trees

Step 3: Apply High Soil Loss Adjustment
  Since soil loss (150) > 100 tons:
  Adjusted quantity = ceil(11 × 1.2) = ceil(13.2) = 14 trees

Final Recommendation:
  Mangrove: 14 trees (increased from 11 due to high soil loss)

================================================================================
SOIL TYPE PLANT RECOMMENDATIONS
================================================================================

Each soil type has specific plants suitable for coastal erosion control:

SANDY SOIL:
  - Coconut trees (40%)
  - Pandan (30%)
  - Mangrove (30%)
  - Beach morning glory (20%)
  - Sea purslane (25%)

CLAY SOIL:
  - Mangrove (35%)
  - Nipa palm (30%)
  - Bakauan (35%)
  - Pandan (20%)
  - Sea hibiscus (25%)

LOAMY SOIL:
  - Coconut trees (35%)
  - Mangrove (30%)
  - Pandan (25%)
  - Beach morning glory (20%)
  - Sea purslane (20%)

SILTY SOIL:
  - Mangrove (40%)
  - Nipa palm (30%)
  - Pandan (25%)
  - Bakauan (35%)
  - Sea hibiscus (20%)

PEATY SOIL:
  - Mangrove (40%)
  - Nipa palm (35%)
  - Bakauan (30%)
  - Pandan (20%)
  - Sea hibiscus (25%)

CHALKY SOIL:
  - Coconut trees (40%)
  - Mangrove (30%)
  - Pandan (30%)
  - Beach morning glory (25%)
  - Sea purslane (25%)

NOTE: The percentages (ratios) represent the distribution of each plant type
in the total recommendation. Percentages may not sum to exactly 100% due to
optimization for different soil conditions.

================================================================================
IMPORTANT NOTES
================================================================================

1. SOIL LOSS FORMULA:
   - The coefficients (81610.062, -54.458, 2665.351, 2048.205) are derived
     from research and statistical analysis
   - These values are specific to coastal erosion prediction models
   - The formula assumes standard conditions and may need adjustment for
     specific local conditions

2. PLANT RECOMMENDATIONS:
   - The "1 tree per 5 tons" ratio is a general guideline
   - Actual requirements may vary based on:
     * Plant species effectiveness
     * Soil composition
     * Climate conditions
     * Erosion severity
     * Local environmental factors
   
   - Plant recommendations are based on general knowledge of coastal
     erosion control plants suitable for tropical/coastal regions
   - These should be validated with:
     * Scientific research data
     * Local agricultural/forestry expert consultation
     * Site-specific environmental conditions
     * Actual field testing results

3. CALCULATION ACCURACY:
   - All calculations use ceiling (ceil) function to round up
   - This ensures conservative estimates (slightly more plants than
     mathematically exact)
   - Minimum quantity of 1 ensures at least some recommendation even
     for very low soil loss

4. HIGH SOIL LOSS ADJUSTMENT:
   - When soil loss exceeds 100 metric tons per year, all plant
     quantities are increased by 20%
   - This accounts for more severe erosion requiring denser planting
   - The threshold (100 tons) and multiplier (1.2) can be adjusted
     based on research and expert recommendations

================================================================================
SUMMARY
================================================================================

SOIL LOSS CALCULATION:
  Formula: 81610.062 - (54.458 × S) + (2665.351 × T) + (2048.205 × F)
  Result: Metric tons per year (minimum 0)

PLANT RECOMMENDATION CALCULATION:
  Step 1: Total = ceil(Soil Loss ÷ 5)
  Step 2: Per Plant = ceil(Total × Plant Ratio)
  Step 3: Adjust for high soil loss if > 100 tons (× 1.2)
  Result: Number of trees/plants per species

================================================================================
For questions or clarifications, please refer to the source code in script.js
or consult with agricultural/forestry experts for validation.
================================================================================

